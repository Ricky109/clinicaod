import{_ as x,r as C,j as v,c as i,a,b as r,t as g,f as n,F as A,w as d,v as E,k as G,n as V,l as _,h as $,m as w,i as F,o}from"./index-Cj1LC5wF.js";import{u as X}from"./pacienteStore-DfTHjeIC.js";import"./pagoService-TImjt0rm.js";const j={class:"card"},z={class:"grid grid-2"},H=["value"],Z={style:{"text-align":"center"}},q=["disabled"],J={key:0,class:"error-message"},K={key:1,class:"mt-2"},Q={class:"grid grid-1"},W=["value"],Y={key:0,class:"campo-obligatorio"},h={key:1,class:"campo-obligatorio"},ee={key:2,class:"campo-obligatorio"},te=["value"],ne={key:0,class:"campo-obligatorio"},ae={key:0,class:"campo-obligatorio"},le={class:"input-group"},oe=["readonly"],ie={class:"action-slot"},se={key:5,class:"campo-obligatorio"},re={class:"mt-2 button-group"},ue={key:2,class:"btn btn-primary btn-buscar",disabled:"",title:"Complete el registro del paciente para continuar"},pe={__name:"BuscarPaciente",setup(ce){const e=X(),m=C(""),N=C(!1),p=C(""),u=C(!1),c=C(!1);function P(s){return s.replace(/\D/g,"").slice(0,8)}function T(s){const t=P(s.target.value);m.value=t,s.target.value=t}function b(s){return s?String(s).toUpperCase().replace(/[^A-ZÁÉÍÓÚÜÑ\s]/g,""):""}async function y(){try{if(p.value="",m.value.length!==8){p.value="El DNI debe tener exactamente 8 dígitos";return}N.value=!0,await e.buscarPaciente(m.value),e.nuevo?(u.value=!1,e.paciente.CAPEPAT="",e.paciente.CAPEMAT="",e.paciente.CNOMBRE=""):u.value=!1}catch(s){p.value=s.message}finally{N.value=!1}}async function R(){try{if(p.value="",e.nuevo){c.value=!0;const s=(e.paciente.CAPEPAT||"").trim(),t=(e.paciente.CAPEMAT||"").trim(),I=(e.paciente.CNOMBRE||"").trim(),l=(e.paciente.DNACIMI||"").toString().trim(),L=(e.paciente.CDNIEST||"").toString().trim(),B=(e.paciente.CNROCEL||"").toString().trim();if(!s||!t||!I||!l||!L||!B)throw new Error("Complete los campos obligatorios");const U=`${e.paciente.CAPEPAT} ${e.paciente.CAPEMAT} ${e.paciente.CNOMBRE}`.trim();e.paciente.CNOMBRE=U}e.paciente.DNACIMI&&(e.paciente.DNACIMI=String(e.paciente.DNACIMI).replace(/-/g,"/")),await e.registrarPaciente(e.paciente),u.value=!1}catch(s){p.value=s.message}}function f(){u.value=!0}function O(){u.value=!1}const S=v(()=>e.nuevo||u.value),D=v(()=>e.nuevo||u.value),M=v(()=>e.nuevo);v(()=>!e.nuevo&&e.paciente);const k=v(()=>!!e.paciente&&!e.nuevo);return(s,t)=>{const I=F("router-link");return o(),i("div",j,[t[24]||(t[24]=a("h2",{style:{"text-align":"center"}},"BUSCAR/REGISTRAR PACIENTE",-1)),a("div",z,[a("input",{class:"input",placeholder:"DNI PACIENTE (8 dígitos)",value:m.value,onInput:T,maxlength:"8",inputmode:"numeric",pattern:"[0-9]{8}"},null,40,H),a("div",Z,[a("button",{class:"btn btn-primary btn-buscar",onClick:y,disabled:N.value||m.value.length!==8},g(N.value?"🔍 Buscando...":"🔍 Buscar"),9,q)])]),p.value?(o(),i("p",J,g(p.value),1)):r("",!0),n(e).paciente?(o(),i("div",K,[t[23]||(t[23]=a("h3",null,"DATOS DEL PACIENTE",-1)),a("div",Q,[t[20]||(t[20]=a("label",null,"DNI:",-1)),a("input",{class:"input input-readonly",value:n(e).paciente.CNRODNI,readonly:""},null,8,W),n(e).nuevo?(o(),i(A,{key:0},[t[12]||(t[12]=a("label",null,"PRIMER APELLIDO:",-1)),d(a("input",{class:"input","onUpdate:modelValue":t[0]||(t[0]=l=>n(e).paciente.CAPEPAT=l),onInput:t[1]||(t[1]=l=>n(e).paciente.CAPEPAT=b(n(e).paciente.CAPEPAT)),placeholder:"INGRESE PRIMER APELLIDO"},null,544),[[E,n(e).paciente.CAPEPAT]]),c.value&&!(n(e).paciente.CAPEPAT||"").trim()?(o(),i("small",Y,"*Campo obligatorio*")):r("",!0),t[13]||(t[13]=a("label",null,"SEGUNDO APELLIDO:",-1)),d(a("input",{class:"input","onUpdate:modelValue":t[2]||(t[2]=l=>n(e).paciente.CAPEMAT=l),onInput:t[3]||(t[3]=l=>n(e).paciente.CAPEMAT=b(n(e).paciente.CAPEMAT)),placeholder:"INGRESE SEGUNDO APELLIDO"},null,544),[[E,n(e).paciente.CAPEMAT]]),c.value&&!(n(e).paciente.CAPEMAT||"").trim()?(o(),i("small",h,"*Campo obligatorio*")):r("",!0),t[14]||(t[14]=a("label",null,"NOMBRES:",-1)),d(a("input",{class:"input","onUpdate:modelValue":t[4]||(t[4]=l=>n(e).paciente.CNOMBRE=l),onInput:t[5]||(t[5]=l=>n(e).paciente.CNOMBRE=b(n(e).paciente.CNOMBRE)),placeholder:"INGRESE NOMBRES"},null,544),[[E,n(e).paciente.CNOMBRE]]),c.value&&!(n(e).paciente.CNOMBRE||"").trim()?(o(),i("small",ee,"*Campo obligatorio*")):r("",!0)],64)):(o(),i(A,{key:1},[t[15]||(t[15]=a("label",null,"NOMBRE:",-1)),a("input",{class:"input input-readonly",value:n(e).paciente.CNOMBRE,readonly:""},null,8,te)],64)),n(e).nuevo?(o(),i(A,{key:2},[t[17]||(t[17]=a("label",null,"SEXO:",-1)),d(a("select",{class:"input","onUpdate:modelValue":t[6]||(t[6]=l=>n(e).paciente.CSEXO=l)},[...t[16]||(t[16]=[a("option",{value:"M"},"MASCULINO",-1),a("option",{value:"F"},"FEMENINO",-1)])],512),[[G,n(e).paciente.CSEXO]])],64)):r("",!0),M.value?(o(),i(A,{key:3},[t[18]||(t[18]=a("label",null,"FECHA DE NACIMIENTO: (DD/MM/AAAA)",-1)),d(a("input",{class:"input",type:"date","onUpdate:modelValue":t[7]||(t[7]=l=>n(e).paciente.DNACIMI=l),placeholder:"DD/MM/AAAA"},null,512),[[E,n(e).paciente.DNACIMI]]),c.value&&!(n(e).paciente.DNACIMI||"").toString().trim()?(o(),i("small",ne,"*Campo obligatorio*")):r("",!0)],64)):r("",!0),M.value?(o(),i(A,{key:4},[t[19]||(t[19]=a("label",null,"DNI DEL TRATANTE:",-1)),d(a("input",{class:"input","onUpdate:modelValue":t[8]||(t[8]=l=>n(e).paciente.CDNIEST=l),onInput:t[9]||(t[9]=l=>n(e).paciente.CDNIEST=n(e).paciente.CDNIEST.replace(/\D/g,"").slice(0,8)),maxlength:"8",inputmode:"numeric",pattern:"[0-9]{8}",placeholder:"INGRESE DNI DEL TRATANTE"},null,544),[[E,n(e).paciente.CDNIEST]]),c.value&&!(n(e).paciente.CDNIEST||"").toString().trim()?(o(),i("small",ae,"*Campo obligatorio*")):r("",!0)],64)):r("",!0),t[21]||(t[21]=a("label",null,"CELULAR DEL PACIENTE:",-1)),a("div",le,[d(a("input",{class:V(["input input-group-field",{"input-readonly":!D.value}]),"onUpdate:modelValue":t[10]||(t[10]=l=>n(e).paciente.CNROCEL=l),onInput:t[11]||(t[11]=l=>n(e).paciente.CNROCEL=n(e).paciente.CNROCEL.replace(/\D/g,"").slice(0,9)),maxlength:"9",inputmode:"numeric",pattern:"[0-9]{9}",readonly:!D.value,placeholder:"INGRESE NÚMERO DE CELULAR"},null,42,oe),[[E,n(e).paciente.CNROCEL]]),a("div",ie,[!n(e).nuevo&&!u.value?(o(),i("button",{key:0,class:"btn-edit right-addon",onClick:f,title:"Editar celular"}," ✏️ ")):u.value&&!n(e).nuevo?(o(),i("button",{key:1,class:"btn btn-secondary btn-cancel",onClick:O}," Cancelar ")):r("",!0)])]),c.value&&!(n(e).paciente.CNROCEL||"").toString().trim()?(o(),i("small",se,"*Campo obligatorio*")):r("",!0)]),a("div",re,[S.value?(o(),i("button",{key:0,class:"btn btn-primary btn-buscar",onClick:R},g(n(e).nuevo?"👤 Registrar Paciente":"💾 Guardar Cambios"),1)):r("",!0),k.value?(o(),_(I,{key:1,class:"btn btn-primary btn-buscar",to:"/atencion"},{default:$(()=>[...t[22]||(t[22]=[w(" 🏥 Tratamiento ",-1)])]),_:1})):(o(),i("button",ue," 🏥 Tratamiento "))])])):r("",!0)])}}},Ce=x(pe,[["__scopeId","data-v-4b4513bf"]]);export{Ce as default};
