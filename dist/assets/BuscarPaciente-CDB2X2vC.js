import{r as N,j as m,c as o,a,b as d,t as I,f as n,w as c,v as E,k,F as y,n as L,g as B,h as U,i as x,o as s,l as V}from"./index-C5m7cYnc.js";import{u as G}from"./pacienteStore-XNkwx3BJ.js";import{_ as $}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./pagoService-TImjt0rm.js";const F={class:"card"},X={class:"grid grid-2"},w=["value"],_={style:{"text-align":"center"}},j=["disabled"],z={key:0,class:"error-message"},H={key:1,class:"mt-2"},q={class:"grid grid-1"},J=["value"],K=["value"],Q=["value"],W=["value"],Y=["value"],Z={class:"celular-container"},h=["readonly"],ee={key:1,class:"edit-buttons"},te={class:"mt-2 button-group"},ne={__name:"BuscarPaciente",setup(ae){const t=G(),v=N(""),C=N(!1),r=N(""),u=N(!1);function P(i){return i.replace(/\D/g,"").slice(0,8)}function D(i){const e=P(i.target.value);v.value=e,i.target.value=e}function O(i){const e=i.trim().split(" ");let p="",l="",A="";return e.length>=3?(p=e[0],l=e[1],A=e.slice(2).join(" ")):e.length===2?(p=e[0],A=e[1]):e.length===1&&(A=e[0]),{apePat:p,apeMat:l,nombres:A}}async function R(){try{if(r.value="",v.value.length!==8){r.value="El DNI debe tener exactamente 8 dígitos";return}C.value=!0;const i=await t.buscarPaciente(v.value);if(!t.nuevo&&i&&t.paciente.CNOMBRE){const{apePat:e,apeMat:p,nombres:l}=O(t.paciente.CNOMBRE);t.paciente.CAPEPAT=e,t.paciente.CAPEMAT=p,t.paciente.CNOMBRE=l,u.value=!1}else t.nuevo&&(u.value=!1)}catch(i){r.value=i.message}finally{C.value=!1}}async function T(){try{if(r.value="",!t.nuevo){const i=`${t.paciente.CAPEPAT} ${t.paciente.CAPEMAT} ${t.paciente.CNOMBRE}`.trim();t.paciente.CNOMBRE=i}t.paciente.DNACIMI&&(t.paciente.DNACIMI=String(t.paciente.DNACIMI).replace(/-/g,"/")),await t.registrarPaciente(t.paciente),u.value=!1}catch(i){r.value=i.message}}function f(){u.value=!0}function g(){u.value=!1}const S=m(()=>t.nuevo||u.value),b=m(()=>t.nuevo||u.value),M=m(()=>t.nuevo);return(i,e)=>{const p=x("router-link");return s(),o("div",F,[e[23]||(e[23]=a("h2",{style:{"text-align":"center"}},"BUSCAR/REGISTRAR PACIENTE",-1)),a("div",X,[a("input",{class:"input",placeholder:"DNI PACIENTE (8 dígitos)",value:v.value,onInput:D,maxlength:"8",inputmode:"numeric",pattern:"[0-9]{8}"},null,40,w),a("div",_,[a("button",{class:"btn btn-primary btn-buscar",onClick:R,disabled:C.value||v.value.length!==8},I(C.value?"🔍 Buscando...":"🔍 Buscar"),9,j)])]),r.value?(s(),o("p",z,I(r.value),1)):d("",!0),n(t).paciente?(s(),o("div",H,[e[22]||(e[22]=a("h3",null,"DATOS DEL PACIENTE",-1)),a("div",q,[e[15]||(e[15]=a("label",null,"DNI:",-1)),a("input",{class:"input input-readonly",value:n(t).paciente.CNRODNI,readonly:""},null,8,J),e[16]||(e[16]=a("label",null,"PRIMER APELLIDO:",-1)),n(t).nuevo?c((s(),o("input",{key:0,class:"input","onUpdate:modelValue":e[0]||(e[0]=l=>n(t).paciente.CAPEPAT=l),onInput:e[1]||(e[1]=l=>n(t).paciente.CAPEPAT=n(t).paciente.CAPEPAT.toUpperCase()),placeholder:"INGRESE PRIMER APELLIDO"},null,544)),[[E,n(t).paciente.CAPEPAT]]):(s(),o("input",{key:1,class:"input input-readonly",value:n(t).paciente.CAPEPAT,readonly:""},null,8,K)),e[17]||(e[17]=a("label",null,"SEGUNDO APELLIDO:",-1)),n(t).nuevo?c((s(),o("input",{key:2,class:"input","onUpdate:modelValue":e[2]||(e[2]=l=>n(t).paciente.CAPEMAT=l),onInput:e[3]||(e[3]=l=>n(t).paciente.CAPEMAT=n(t).paciente.CAPEMAT.toUpperCase()),placeholder:"INGRESE SEGUNDO APELLIDO"},null,544)),[[E,n(t).paciente.CAPEMAT]]):(s(),o("input",{key:3,class:"input input-readonly",value:n(t).paciente.CAPEMAT,readonly:""},null,8,Q)),e[18]||(e[18]=a("label",null,"NOMBRES:",-1)),n(t).nuevo?c((s(),o("input",{key:4,class:"input","onUpdate:modelValue":e[4]||(e[4]=l=>n(t).paciente.CNOMBRE=l),onInput:e[5]||(e[5]=l=>n(t).paciente.CNOMBRE=n(t).paciente.CNOMBRE.toUpperCase()),placeholder:"INGRESE NOMBRES"},null,544)),[[E,n(t).paciente.CNOMBRE]]):(s(),o("input",{key:5,class:"input input-readonly",value:n(t).paciente.CNOMBRE,readonly:""},null,8,W)),e[19]||(e[19]=a("label",null,"SEXO:",-1)),n(t).nuevo?c((s(),o("select",{key:6,class:"input","onUpdate:modelValue":e[6]||(e[6]=l=>n(t).paciente.CSEXO=l)},[...e[12]||(e[12]=[a("option",{value:"M"},"MASCULINO",-1),a("option",{value:"F"},"FEMENINO",-1)])],512)),[[k,n(t).paciente.CSEXO]]):(s(),o("input",{key:7,class:"input input-readonly",value:n(t).paciente.CSEXO?n(t).paciente.CSEXO==="M"?"MASCULINO":n(t).paciente.CSEXO==="F"?"FEMENINO":n(t).paciente.CSEXO:"",readonly:""},null,8,Y)),M.value?(s(),o(y,{key:8},[e[13]||(e[13]=a("label",null,"FECHA DE NACIMIENTO: (DD/MM/AAAA)",-1)),c(a("input",{class:"input",type:"date","onUpdate:modelValue":e[7]||(e[7]=l=>n(t).paciente.DNACIMI=l),placeholder:"DD/MM/AAAA"},null,512),[[E,n(t).paciente.DNACIMI]])],64)):d("",!0),M.value?(s(),o(y,{key:9},[e[14]||(e[14]=a("label",null,"DNI DEL TRATANTE:",-1)),c(a("input",{class:"input","onUpdate:modelValue":e[8]||(e[8]=l=>n(t).paciente.CDNIEST=l),onInput:e[9]||(e[9]=l=>n(t).paciente.CDNIEST=n(t).paciente.CDNIEST.replace(/\D/g,"").slice(0,8)),maxlength:"8",inputmode:"numeric",pattern:"[0-9]{8}",placeholder:"INGRESE DNI DEL TRATANTE"},null,544),[[E,n(t).paciente.CDNIEST]])],64)):d("",!0),e[20]||(e[20]=a("label",null,"CELULAR DEL PACIENTE:",-1)),a("div",Z,[c(a("input",{class:L(["input",{"input-readonly":!b.value}]),"onUpdate:modelValue":e[10]||(e[10]=l=>n(t).paciente.CNROCEL=l),onInput:e[11]||(e[11]=l=>n(t).paciente.CNROCEL=n(t).paciente.CNROCEL.replace(/\D/g,"").slice(0,9)),maxlength:"9",inputmode:"numeric",pattern:"[0-9]{9}",readonly:!b.value,placeholder:"INGRESE NÚMERO DE CELULAR"},null,42,h),[[E,n(t).paciente.CNROCEL]]),!n(t).nuevo&&!u.value?(s(),o("button",{key:0,class:"btn-edit",onClick:f,title:"Editar celular"}," ✏️ ")):d("",!0),u.value&&!n(t).nuevo?(s(),o("div",ee,[a("button",{class:"btn btn-secondary btn-sm",onClick:g},"CANCELAR")])):d("",!0)])]),a("div",te,[S.value?(s(),o("button",{key:0,class:"btn btn-primary btn-buscar",onClick:T},I(n(t).nuevo?"👤 Registrar Paciente":"💾 Guardar Cambios"),1)):d("",!0),B(p,{class:"btn btn-primary btn-buscar",to:"/atencion"},{default:U(()=>[...e[21]||(e[21]=[V(" 🏥 Tratamiento ",-1)])]),_:1})])])):d("",!0)])}}},ue=$(ne,[["__scopeId","data-v-5be17975"]]);export{ue as default};
