import{u as m,r as g,C as f,c as a,a as s,t as n,b as D,k as N,F as A,z as C,o as r,i as u,n as O}from"./index-ByBmmahU.js";import{h as I}from"./pagoService-BvGXah5e.js";import{_ as S}from"./_plugin-vue_export-helper-DlAUqK2U.js";const T={class:"card"},y={key:0,class:"cargando"},w={key:1,class:"error-message"},L={key:2,class:"historial-container"},P={key:0,class:"no-pacientes"},_={class:"historial-row"},h={class:"historial-row"},k={class:"historial-row"},U={class:"historial-row"},x={class:"historial-row"},H={__name:"Historial",setup(b){const l=m(),d=g([]),c=g(!1),i=g("");f(async()=>{await E()});async function E(){var t,o;try{c.value=!0,i.value="";const e=l.codigoEstudiante;if(!e){i.value="No se encontró el código de estudiante";return}console.log("Usuario autenticado completo:",l.user),console.log("CDNIALU (identificador principal):",(t=l.user)==null?void 0:t.CDNIALU),console.log("CCODALU (alternativo):",(o=l.user)==null?void 0:o.CCODALU),console.log("Código de estudiante seleccionado:",e),d.value=await I(e),console.log("Pacientes atendidos encontrados:",d.value)}catch(e){i.value=e.message||"Error al cargar el historial de pacientes",console.error("Error:",e)}finally{c.value=!1}}function p(t){switch(t.toLowerCase()){case"pagado":return{icon:"✔️",class:"estado-pagado"};case"pendiente":return{icon:"⏳",class:"estado-pendiente"};case"anulado":return{icon:"❌",class:"estado-anulado"};default:return{icon:"❔",class:"estado-desconocido"}}}function v(t){return t?new Date(t).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric"}):"No disponible"}return(t,o)=>(r(),a("div",T,[o[11]||(o[11]=s("h2",{style:{"text-align":"center"}},"HISTORIAL DE PACIENTES ATENDIDOS",-1)),c.value?(r(),a("div",y,[...o[0]||(o[0]=[s("p",null,"Cargando historial de pacientes...",-1)])])):i.value?(r(),a("div",w,[s("p",null,n(i.value),1)])):(r(),a("div",L,[d.value.length===0?(r(),a("div",P,[o[1]||(o[1]=s("p",null,"NO HAY PACIENTES ATENDIDOS POR ESTE ESTUDIANTE",-1)),s("p",null,"CÓDIGO DE ESTUDIANTE: "+n(N(l).codigoEstudiante||"NO DISPONIBLE"),1)])):D("",!0),(r(!0),a(A,null,C(d.value,e=>(r(),a("div",{key:e.codigo,class:"historial-card"},[s("div",_,[o[2]||(o[2]=s("strong",null,"PACIENTE:",-1)),o[3]||(o[3]=u()),s("span",null,n(e.paciente),1)]),s("div",h,[o[4]||(o[4]=s("strong",null,"NÚMERO DE PAGO:",-1)),o[5]||(o[5]=u()),s("span",null,n(e.codigo),1)]),s("div",k,[o[6]||(o[6]=s("strong",null,"MONTO:",-1)),o[7]||(o[7]=u()),s("span",null,"S/ "+n(e.monto.toFixed(2)),1)]),s("div",U,[o[8]||(o[8]=s("strong",null,"ESTADO:",-1)),s("span",{class:O(["estado-icon",p(e.estado).class])},n(p(e.estado).icon),3)]),s("div",x,[o[9]||(o[9]=s("strong",null,"FECHA:",-1)),o[10]||(o[10]=u()),s("span",null,n(v(e.fecha)),1)])]))),128))]))]))}},R=S(H,[["__scopeId","data-v-be863590"]]);export{R as default};
