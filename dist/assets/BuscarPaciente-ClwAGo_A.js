import{r as N,j as m,c as o,a as l,b as d,t as I,k as n,w as E,v as c,l as L,F as P,n as k,f as B,g as U,h as x,o as s,i as V}from"./index-ByBmmahU.js";import{u as G}from"./pacienteStore-Dok7PMhB.js";import{_ as $}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./pagoService-BvGXah5e.js";const F={class:"card"},w={class:"grid grid-2"},X=["value"],_={style:{"text-align":"center"}},j=["disabled"],z={key:0,class:"error-message"},H={key:1,class:"mt-2"},q={class:"grid grid-1"},J=["value"],K=["value"],Q=["value"],W=["value"],Y=["value"],Z={class:"celular-container"},h=["readonly"],ee={key:1,class:"edit-buttons"},te={class:"mt-2 button-group"},ne={__name:"BuscarPaciente",setup(le){const t=G(),v=N(""),C=N(!1),r=N(""),u=N(!1);function y(i){return i.replace(/\D/g,"").slice(0,8)}function O(i){const e=y(i.target.value);v.value=e,i.target.value=e}function M(i){const e=i.trim().split(" ");let p="",a="",A="";return e.length>=3?(p=e[0],a=e[1],A=e.slice(2).join(" ")):e.length===2?(p=e[0],A=e[1]):e.length===1&&(A=e[0]),{apePat:p,apeMat:a,nombres:A}}async function b(){try{if(r.value="",v.value.length!==8){r.value="El DNI debe tener exactamente 8 dígitos";return}C.value=!0;const i=await t.buscarPaciente(v.value);if(!t.nuevo&&i&&t.paciente.CNOMBRE){const{apePat:e,apeMat:p,nombres:a}=M(t.paciente.CNOMBRE);t.paciente.CAPEPAT=e,t.paciente.CAPEMAT=p,t.paciente.CNOMBRE=a,u.value=!1}else t.nuevo&&(u.value=!1)}catch(i){r.value=i.message}finally{C.value=!1}}async function f(){try{if(r.value="",!t.nuevo){const i=`${t.paciente.CAPEPAT} ${t.paciente.CAPEMAT} ${t.paciente.CNOMBRE}`.trim();t.paciente.CNOMBRE=i}await t.registrarPaciente(t.paciente),u.value=!1}catch(i){r.value=i.message}}function D(){u.value=!0}function g(){u.value=!1}const S=m(()=>t.nuevo||u.value),R=m(()=>t.nuevo||u.value),T=m(()=>t.nuevo);return(i,e)=>{const p=x("router-link");return s(),o("div",F,[e[23]||(e[23]=l("h2",{style:{"text-align":"center"}},"BUSCAR/REGISTRAR PACIENTE",-1)),l("div",w,[l("input",{class:"input",placeholder:"DNI PACIENTE (8 dígitos)",value:v.value,onInput:O,maxlength:"8",inputmode:"numeric",pattern:"[0-9]{8}"},null,40,X),l("div",_,[l("button",{class:"btn btn-SALIR",onClick:b,disabled:C.value||v.value.length!==8},I(C.value?"BUSCANDO...":"BUSCAR"),9,j)])]),r.value?(s(),o("p",z,I(r.value),1)):d("",!0),n(t).paciente?(s(),o("div",H,[e[22]||(e[22]=l("h3",null,"DATOS DEL PACIENTE",-1)),l("div",q,[e[15]||(e[15]=l("label",null,"DNI:",-1)),l("input",{class:"input input-readonly",value:n(t).paciente.CNRODNI,readonly:""},null,8,J),e[16]||(e[16]=l("label",null,"APELLIDO PATERNO:",-1)),n(t).nuevo?E((s(),o("input",{key:0,class:"input","onUpdate:modelValue":e[0]||(e[0]=a=>n(t).paciente.CAPEPAT=a),onInput:e[1]||(e[1]=a=>n(t).paciente.CAPEPAT=n(t).paciente.CAPEPAT.toUpperCase()),placeholder:"INGRESE APELLIDO PATERNO"},null,544)),[[c,n(t).paciente.CAPEPAT]]):(s(),o("input",{key:1,class:"input input-readonly",value:n(t).paciente.CAPEPAT,readonly:""},null,8,K)),e[17]||(e[17]=l("label",null,"APELLIDO MATERNO:",-1)),n(t).nuevo?E((s(),o("input",{key:2,class:"input","onUpdate:modelValue":e[2]||(e[2]=a=>n(t).paciente.CAPEMAT=a),onInput:e[3]||(e[3]=a=>n(t).paciente.CAPEMAT=n(t).paciente.CAPEMAT.toUpperCase()),placeholder:"INGRESE APELLIDO MATERNO"},null,544)),[[c,n(t).paciente.CAPEMAT]]):(s(),o("input",{key:3,class:"input input-readonly",value:n(t).paciente.CAPEMAT,readonly:""},null,8,Q)),e[18]||(e[18]=l("label",null,"NOMBRES:",-1)),n(t).nuevo?E((s(),o("input",{key:4,class:"input","onUpdate:modelValue":e[4]||(e[4]=a=>n(t).paciente.CNOMBRE=a),onInput:e[5]||(e[5]=a=>n(t).paciente.CNOMBRE=n(t).paciente.CNOMBRE.toUpperCase()),placeholder:"INGRESE NOMBRES"},null,544)),[[c,n(t).paciente.CNOMBRE]]):(s(),o("input",{key:5,class:"input input-readonly",value:n(t).paciente.CNOMBRE,readonly:""},null,8,W)),e[19]||(e[19]=l("label",null,"SEXO:",-1)),n(t).nuevo?E((s(),o("select",{key:6,class:"input","onUpdate:modelValue":e[6]||(e[6]=a=>n(t).paciente.CSEXO=a)},[...e[12]||(e[12]=[l("option",{value:"M"},"MASCULINO",-1),l("option",{value:"F"},"FEMENINO",-1)])],512)),[[L,n(t).paciente.CSEXO]]):(s(),o("input",{key:7,class:"input input-readonly",value:n(t).paciente.CSEXO==="M"?"MASCULINO":"FEMENINO",readonly:""},null,8,Y)),T.value?(s(),o(P,{key:8},[e[13]||(e[13]=l("label",null,"FECHA DE NACIMIENTO:",-1)),E(l("input",{class:"input",type:"date","onUpdate:modelValue":e[7]||(e[7]=a=>n(t).paciente.DNACIMI=a),placeholder:"Seleccione fecha de nacimiento"},null,512),[[c,n(t).paciente.DNACIMI]])],64)):d("",!0),T.value?(s(),o(P,{key:9},[e[14]||(e[14]=l("label",null,"DNI DEL TRATANTE:",-1)),E(l("input",{class:"input","onUpdate:modelValue":e[8]||(e[8]=a=>n(t).paciente.CDNIEST=a),onInput:e[9]||(e[9]=a=>n(t).paciente.CDNIEST=n(t).paciente.CDNIEST.replace(/\D/g,"").slice(0,8)),maxlength:"8",inputmode:"numeric",pattern:"[0-9]{8}",placeholder:"INGRESE DNI DEL TRATANTE"},null,544),[[c,n(t).paciente.CDNIEST]])],64)):d("",!0),e[20]||(e[20]=l("label",null,"CELULAR DEL PACIENTE:",-1)),l("div",Z,[E(l("input",{class:k(["input",{"input-readonly":!R.value}]),"onUpdate:modelValue":e[10]||(e[10]=a=>n(t).paciente.CNROCEL=a),onInput:e[11]||(e[11]=a=>n(t).paciente.CNROCEL=n(t).paciente.CNROCEL.replace(/\D/g,"").slice(0,9)),maxlength:"9",inputmode:"numeric",pattern:"[0-9]{9}",readonly:!R.value,placeholder:"INGRESE NÚMERO DE CELULAR"},null,42,h),[[c,n(t).paciente.CNROCEL]]),!n(t).nuevo&&!u.value?(s(),o("button",{key:0,class:"btn-edit",onClick:D,title:"Editar celular"}," ✏️ ")):d("",!0),u.value&&!n(t).nuevo?(s(),o("div",ee,[l("button",{class:"btn btn-secondary btn-sm",onClick:g},"CANCELAR")])):d("",!0)])]),l("div",te,[S.value?(s(),o("button",{key:0,class:"btn btn-primary",onClick:f},I(n(t).nuevo?"REGISTRAR PACIENTE":"GUARDAR CAMBIOS"),1)):d("",!0),B(p,{class:"btn btn-SALIR",to:"/atencion"},{default:U(()=>[...e[21]||(e[21]=[V(" TRATAMIENTO ",-1)])]),_:1})])])):d("",!0)])}}},ue=$(ne,[["__scopeId","data-v-6d5a9ed6"]]);export{ue as default};
